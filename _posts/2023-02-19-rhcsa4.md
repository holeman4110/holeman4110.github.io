---
layout: single
title: "RHCSA Practice Test"
categories: os
tags: [2023/02/19, 운영체제, RHCSA, 레드햇]
toc: true
toc_sticky: true
author_profile: true
comments: true
share: true
related: true
published: true
hidden: false
sidebar: 
    nav: "docs"
---

## 1. 서론  

&nbsp;&nbsp;&nbsp;&nbsp; 기존에 공부한 내용들을 연습하고 수정할 부분은 수정하여 최종적으로 모아 연습해볼 수 있도록 만든 포스팅이다.

## 2. 본론  

```
# systemctl get-defalut
# systemctl set-default graphical.target //재부팅시 반영
# systemctl isolate graphical.target //현재 세션에 즉시 반영
```

### 1-1. Emegerncy Mode

```
Enter emergency mode and do system recovery process.
Root Passwd : '1234'
```

```
Fine line end with linux, add 'systemd.unit=emergency.target'
ctrl + d
keduit
```

### 1-2. Configure Host Name, IP Address, Gateway and DNSPermalink

#### 1. 예제1 

```
Host Name: keduit.example.com
IPv4 address: 192.168.122.10
Subnet mask: 255.255.255.0
Default Gateway: 192.168.122.1
DNS Server: 192.168.100.1
Interface Name: eth0
```

```
# ip addr 
// ifconfig는 Network Manager에서 설정한 정보가 출력되지 않음
# nmtui
IPv4 CONFIGURATION <Automatic> -> <Manual>
Then add above info
Uncheck 'Automaticaaly connect'
Activate a Connection -> Twice
Set Hostname as above
# ip addr
```

#### 2. 예제2

```
Host Name: keduit.example.com
IPv4 address: 192.168.122.10
Subnet mask: 255.255.255.0
Default Gateway: 192.168.122.1
DNS Server: 192.168.100.1
Interface Name: eth0
//You can't use nmtui
```

```
# systemctl status NetworkManager
# ip addr
# nmcli connection show
# nmcli connection add con-name static ifname eth0 type ethernet ipv4.addresses 192.168.122.10/24 ipv4.dns 192.168.100.1 ipv4.gateway 192.168.122.1 ipv4.method manual
// RHEL9부터 NetworkManager가 default기 때문에 /etc/sysconfig/network-scripts를 수정하는 것을 권장하지 않음(수정하여 사용은 가능하나 NetworkManager의 conf와 겹칠 경우 우선순위가 밀림)
# systemctl restart NetworkManager
# ip addr
# nmcli connection show
```

### 1-3. Base Repo

```
Base = https://mirror.stream.centos.org/9-stream/BaseOS/
Appstream = https://mirror.stream.centos.org/9-stream/AppStream/
gpgkey = x.x.x.x
Configure base repository with appstream. And then activate gpgkey as above.
```

```
# cat /etc/redhat-release //Check Version
# vim /etc/yum.repos.d/
# vim local.repo //새롭게 파일추가. 확실하진 않으나 기존에 연습했던 dnf config-manager, yum config-manager는 시험에서 사용 못한다는 글을봄

[BaseOS]
name=BaseOS
baseurl=https://mirror.stream.centos.org/9-stream/BaseOS/
gpgcheck=1 //gpgkey 안주어지면 0으로
gpgkey=x.x.x.x
enabled=1

[AppStream]
name=AppSteam
baseurl=https://mirror.stream.centos.org/9-stream/AppStream/
gpgcheck=1 //gpgkey 안주어지면 0으로
gpgkey=x.x.x.x
enabled=1

# dnf clean all
# subscription-manager clean
# subscription-manager register //hit enter to add useranme and password
# dnf repolist
# dnf update -y

//Optional
# dnf config-manager --add-repo=https://mirrors.tuna.tsinghua.edu.cn/centos-stream/9-stream/BaseOS/$basearch/os/
# dnf config-manager --add-repo=https://mirrors.tuna.tsinghua.edu.cn/centos-stream/9-stream/AppStream/$basearch/os/
```

### 1-4. Add User(Group)

#### 1. 예제1

```
Add 3 users: kim, kang, choi(user id=1111).
Those 3 user's password is 'keduit'
The requirements: The Additional group of the two users: kim, kang is the keduit group(group id=111). The user: choi's login shell should be non-interactive.
Add user 'teacher' who can use sudo command without passwd.
```

### 1-5. File permission

```
Copy /etc/fstab to /var/tmp. Change owner group to 'keduit', the user 'kim' could read, write and modify it, while user 'kang' without any permission.
```

### 1-6. SELinux

#### 1. 예제1

```
SELinux is disabled now. Turn it on and make it permanent.
```

#### 2. 예제2

```
httpd's default directory is /var/www/html, do not delete related files and directories.
Connect to this server through web browser, and check if html files in /var/www/html/ are visible normally.
httpd's default port is 82, do not change.
httpd have to be on after reboot.
SELinux is Enforcing now, this makes httpd failed.
```

### 1-7. Crontab

```
Configure a task: plan to run below command every 2mins by user kim
logger RH200 exam
```

```
# su kim
# systemctl status crond
# stytemctl enable --now crond
# crontab -e
*/2 * * * * logger RH200 exam
# crontab -l
```

### 1-8. Shared directory

```
Make directory named 'home/shared'
Only 'keduit' group can read and write on above dir.
Any other users can do nothing on that.
But root can do anything.
Made files in shared dir are automatically owned by group 'keduit'
```

### 1-9. NTP(Chrony)

```
Configure ntp client to sync time through kr.pool.ntp.org
```

```
# timedatectl
# systemctl status cronyd
# firewall-cmd --list-all
# firewall-cmd --add-service ntpd --permanent
# firewall-cmd --add-service ntp --permananet
# firewall-cmd --reload
# find / -name chrony.*
# vim /etc/chrony.conf
server kr.pool.ntp.org ibursr //추가
# systemctl enable --now chronyd
# systemctl restart chronyd
# chronyc sources -v
# timedatactl set-ntp true
# timedatectl
// System clock synchronized:yes, NTP service: active 2가지 확인
```

### 1-10. Find files

```
Make directory /root/findfiles
Find the files owned by user 'kim', and copy it to /root/findfiles
```

```
# mkdir -p /root/findfiles
# find / -user kim | xargs -t cp /root/findfiles
```

### 1-11. Find String

```
Find the rows that contain pizza from file /etc/pizzafile, and write it to the /tmp/pizza.txt
```

```
# grep pizza /etc/pizzafile >> /tmp.pizza.txt
```

### 1-12. nfs / autofs 

```
Configure autofs to make sure after login successfully. 1. edit /etc/fstab 2. via autofs. Try both ways.
```

### 1-13. podman

#### 1. 예제1

```
Download a-b-c in provided registry, and then run as dd
Configure it's only running by user 'kim'.
Also it should be running automatically after reboot.
```

```
# dnf search podman
# dnf install -y podman.x86_64
# loginctl enable-linger //일반user도 container 사용가능하게 하는 명령
# cat /etc/containers/registries.conf //사용가능한 registry 확인
# su kim
# podman search registry.name(url)/a-b-c
# podman pull registry.name(url)/rhel9/a-b-c
# podman registry run --name dd //tab
# podman start dd
# podman ps
# cd /home/kim/.config
# mkdir -p systemd/user
# podman generate systemd --name dd --files
# systemctl --user enable --now container-dd.service
```

```
# vim /etc/systemd.journal.conf
Storage=persistent
# systemctl restart systemd-journald.service
# su kim
# mkdir -p /home/containers/contianer_journal
# exit
# find /var/log/journal -name "*.journal" | xargs cp -t /home/containers/container_journal/
```

### 1-14 Password Aging Control

```
Change PASS_MAX_DAYS to 20
```

```
# vim /etc/login.defs
/PASS_MAX로 해당 라인 찾아서 20으로 바꿔주기
# find / -name login.* //정확한 파일 이름 및 경로 생각 안날때 참고
```

### 1-15 Archive(Backup)

```
Create a backup file named /root/backuptest.tar.bz2, contains the content of /usr/localtest, tar must use bzip2 to compress.
```

### 2-1. Reset root password

#### 1. 예제1

```
Reset root passwd to 'keduit'
```

```
rd.break //Find line start with linux, then add 'rd.breadk' at the end of line.
ctrl + x
# mount -o remount,rw /sysroot
# chroot /sysroot
# password root
keduit
keduit
# touch ./autorelabel //'fixfiles onboot'도 사용가능
ctrl + d
ctrl + d
```

#### 2. 예제2

```
Reset root passwd to 'keduit'
But rd.break is not working now. Use different ways.
//RHEL9에는 rd.break로 root password 초기화가 안되는 버그가 발생하고 있기 때문에 준비 필요. (https://bugzilla.redhat.com/show_bug.cgi?id=2057365)
```

```
In linux line change ro to rw and add init=/bin/bash at the end of the line. 
ctrl + x
# mount -o remount,rw /
# passwd root
keduit
keduit
# touch ./autorelabel
# exec /sbin/init
```

### 2-2. Logical Volume

#### 1. 예제1

```
Change the logical volume capacity named vo(volume group) from 190M to 300M. and the size of the floating range should set between 280 and 320. (This logical volume has been mounted in advance.)
```

#### 2. 예제2

```
Create a volume group(lv), and set 8M as a extends. Divided a volume group containing 50 extends on volume group lv (lvshare). And the size of the floating range should set between 380M and 400M.
```

### 2-3. Swap Partition

```
Create a 1G partition in /dev/sde, make it as ext4 file system, mounted automatically under /dev/sde and which take effect automatically at boot-start. Use fdisk for making swapfile.
```


### 2-4 tuned

```
Change tuned to recommended
```

```
# dnf install -y tuned
# systemctl enable --now tuned
# tuned-adm recommend //tuned recommend the most suitable profile for my system
# tuned-adm profile virtual-guest //virtual-gest profile 적용
# tuned-adm active //View the current active Tuned profile
# reboot
# tuned-adm verify
```

### 2-5 ftp(+ update kernel)

```
Install a FTP server, and request to anonymous download from /var/ftp/pub catalog. (it needs you to configure yum direct to the already existing file server.)
```

### 2-6 ip forward

```
Please open the ip_forward, and take effect permanently.
```

```
# sysctl net.ipv4.ip_forward
// '0' means off, '1' means on
# vim /etc/sysctl.conf
net.ipv4.ip_forward=1 //Add this line to the bottom of the file
# sysctl -w net.ipv4.ip_forward=1 //현재 세션에만 적용하려면 이 커맨드도 사용가능
```

### 2-7 Hard Link, Soft(Symbolic) Link

```
Make a /etc/linktest.txt 
Make a Hard Link named hlink at /etc/linkexam/
Make a Soft Link named slink at /etc/linkexam/
```

```
# ln /etc/linktest.txt /etc/linkexam/hlink 
# ln -s /etc/linktest.txt /etc/linkexam/slink 
```

## 3. 결론  

&nbsp;&nbsp;&nbsp;&nbsp; RHCSA 시험까지 3일남았다.

```bash
클라우드 개발자를 넘어 데브옵스를 꿈꾸는 이제 막 공부를 시작한 초보 엔지니어입니다. 틀린 점이 있으면 친절하게 댓글 부탁드립니다. :)
```

---
