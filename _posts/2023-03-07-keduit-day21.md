---
layout: single
title: "클라우드 컴퓨팅과 보안솔루션을 활용한 DC 엔지니어 양성교육 - Day21"
categories: keduit
tags: [2023/03/07, Day21, 한국정보교육원, 국비교육, 네트워크, 운영체제, 하드웨어]
toc: true
toc_sticky: true
author_profile: true
comments: true
share: true
related: true
published: true
hidden: false
sidebar: 
    nav: "docs"
---

## 1. 서론  

&nbsp;&nbsp;&nbsp;&nbsp; 

## 2. 본론  

### 1. Cisco IOS  

#### 1. VLAN

<img alt="ex" src="https://user-images.githubusercontent.com/124491456/223287517-a1a2a47f-f6fb-44b9-8b23-56066966f87d.png" width=400>

&nbsp;&nbsp;&nbsp;&nbsp;위와 같은 구조를 Global Vlan이라고 하며 구성은 아래와 같이 할 수 있다.

```
//SW 1-4
# conf t
# no ip domain lookup
# line c 0
# logging sync
# exec-t 0
```

```
//SW1
# vlan 10
# exit
# vlan 20
# exit
# int range f1/1 - 2
# switchport trunk enc dot
# switchport mode trunk
# exit
# int lo0
# ip add 1.1.1.1 255.255.255.0
# int vlan 10
# ip add 1.1.10.254 255.255.255.0 //SVI for gateway
# exit
# int vlan 20
# ip add 1.1.20.254 255.255.255.0
# end
# copy r s
```

```
//SW2
# no ip routing
# vlan 10
# exit
# vlan 20
# exit
# int range f1/1 - 2
# switchport trunk enc dot
# switchport mode trunk
# end
# copy r s
```

```
//SW3
# no ip routing
# vlan 10
# exit
# vlan 20
# exit
# int range f1/3 - 4
# switchport trunk enc dot
# switchport mode trunk
# end
# copy r s
```

```
//SW4
# no ip routing
# vlan 10
# exit
# vlan 20
# exit
# int range f1/3 - 4
# switchport trunk enc dot
# switchport mode trunk
# exit
# int f1/1
# switchport mode access
# switchport access vlan 10
# exit
# int f1/2
# switchport mode access
# switchport access vlan 20
# end
# copy r s
```

```
//PC1
# conf t
# no ip routing
# ip default-gateway 1.1.10.254
# int f0/0
# no sh
# ip add 1.1.10.1 255.255.255.0
# end
# copy r s
```

```
//PC2
# conf t
# no ip routing
# ip default-gateway 1.1.20.254
# int f0/0
# no sh
# ip add 1.1.20.2 255.255.255.0
# end
# copy r s
```

&nbsp;&nbsp;&nbsp;&nbsp;Bridge ID의 앞 2bytes가 Priority를 할당하는데 쓰이는데, 2bytes 중 첫 4bits를 priority 그다음 12bits를 vlan ID로 쓰이는데 이를 Extended Priority라고 한다. 여기서 vlan ID는 자동으로 할당되므로 priority는 맨앞 4bits에 올 수 있는 값만 부여할 수 있으므로 4096의 배수만 올 수 있다. 위의 구조에서는 STP에 의해 SW4의 f1/4는 block되어 부하를 분산할 수 없다. 이를 분산하기 위하여 아래와 같이 Priority 값을 조절할 수 있다. 

```
//SW1
# conf t
# spanning-tree vlan 10 priority 0 //priority 0으로 만듦으로써 확실한 root로 만듦
# spanning-tree vlan 20 priority 0
```

```
//SW2
# conf t
# spanning-tree vlan 10 priority 4096
# spanning-tree vlan 20 priority 8192
```

```
//SW3
# conf t
# spanning-tree vlan 10 priority 8192
# spanning-tree vlan 20 priority 4096
```

&nbsp;&nbsp;&nbsp;&nbsp;하지만 위와 같은 수동 조정 방식은 새로운 스위치가 추가되거나 할 때 Root를 유지할 수 없을수도 있다는 단점이 있다. 이를 위해서 자동으로 서로의 priority를 조정하는 방법이 있는데 이는 아래와 같다.

```
//SW1-4
위에서 준 priority 값 삭제
```

```
//SW1
# spanning-tree vlan 10 root primary
# spanning-tree vlan 20 root primary
```

```
//SW2
# spanning-tree vlan 10 root secondary //secondary 다음은 없음.
```

```
//SW3
# spanning-tree vlan 20 root secondary
```

```
//SW4
# show spanning-tree vlan 10 br //confirm
# show spanning-tree vlan 20 br
```

&nbsp;&nbsp;&nbsp;&nbsp;위의 설정으로는 vlan 10은 SW4의 f1/3을 통해서 왼쪽 루트로 통행한다. 그리고 vlan 20은 SW4의 f1/4를 통해서 오른쪽 루트로 통행한다. 이를 바꾸고 싶으면 Bridge ID의 Priority 보다 우선시되는 cost를 변경할 수 있다.

```
//SW4
# int f1/3
# spanning-tree vlan 20 cost 5
# spanning-tree vlan 10 cost 5
```





















## 3. 결론  

&nbsp;&nbsp;&nbsp;&nbsp;

## 4. 참고자료  

Ⅰ. 문웅호, 정보통신망   
Ⅱ. 문웅호, 하드웨어

---

```bash
클라우드 개발자를 넘어 데브옵스를 꿈꾸는 이제 막 공부를 시작한 초보 엔지니어입니다. 틀린 점이 있으면 친절하게 댓글 부탁드립니다. :)
```

---
