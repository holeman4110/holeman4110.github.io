---
layout: single
title: "RHCSA Day1(Root Passwd, Configure Network, Add User(Group), File Permission, Sync Time, Base Repo)"
categories: os
tags: [2023/02/16, 운영체제, RHCSA, 레드햇]
toc: true
toc_sticky: true
author_profile: true
comments: true
share: true
related: true
published: true
sidebar: 
    nav: "docs"
---

## 1. 서론  

&nbsp;&nbsp;&nbsp;&nbsp; RHCSA Certificate 공부를 위해 다뤄볼 여러가지 유형들을 복습하기 좋게 정리해보려고 한다.

## 2. 본론  

### 1. Reset root password in CentOS9

![choose_kernel](https://user-images.githubusercontent.com/124491456/219213676-b6eaab49-7167-48f8-a404-596434b5e389.png)

Emergency Mode로 진입하기 위해서는 부팅시 커널 선택 화면(위 사진)에서 'e'키를 눌러서 Grub(GRand unified Boot Loader) Boot Option 화면에 진입할 수 있다.

![GrubBoot](https://user-images.githubusercontent.com/124491456/219214140-c9b70e4b-6166-48dc-9c9a-ad4ad89b9f72.png)

그러면 위와 같은 화면이 뜨는데 여기서 linux로 시작하는 라인을 찾아 ```systemd.unit=emergency.target```를 추가해준다.

![systemdunit](https://user-images.githubusercontent.com/124491456/219214622-d2fd4ff1-93fe-4422-902b-a3782f3f139f.png)

그리고 Ctrl + x를 누르면 부팅이 진행되고 Emergency Prompt가 뜨는데 여기서 루트암호를 입력하면 시스템 복구 작업을 진행할 수 있다.

하지만 루트 암호를 잃어버렸을 경우 복구할 수 없기 때문에, Grub Boot Option에 Boot Process의 초기 단계만 수행해야 하는데 여기에는 여러가지 방법이 있다.

Option1. rd.break 

![rdbreak](https://user-images.githubusercontent.com/124491456/219215463-6ed52ae6-e7ef-4f86-9e72-0a7486346a99.png)

위 사진처럼 아까처럼 Emergency Mode로 진입 후 linux 라인 끝에 ```rd.break```를 추가한 후 Ctrl + x를 눌러 부팅을 진행한다.

![switch_root](https://user-images.githubusercontent.com/124491456/219215865-45ef5dff-714f-441a-a672-c20243a72585.png)

그러면 Prompt가 위의 사진처럼 switch_root로 나타난다. 

```
# mount -o remount,rw /sysroot //다시 읽기,쓰기로 마운트
# chroot /sysroot //루트파일 시스템 변경
# passwd root //root 패스워드 설정
# fixfiles onboot //SELinux context relabeling
ctrl + d 
ctrl + d
```

Option2. rw init=/bin/bash

위에서 입력했던 ```rd.break```대신 linux 라인 끝에 ```rw init=/bin/bash```를 입력 후 Ctrl + x를 눌러 부팅을 진행한다.

```
# touch /.autorelabel //SELinux context relabeling
# passwd root //root 패스워드 설정
# exec /sbin/init
```

### 2. Configure Host Name, IP Address, Gateway and DNS

```
Host Name: keduit.example.com
IP Address: x.x.x.x/24
Gateway: x.x.x.x
DNS: x.x.x.x
```

위의 과제를 수행하기 위해서는 여러가지 옵션이 있다.

#### 1. nmtui

![nmtui](https://user-images.githubusercontent.com/124491456/219220003-4967c220-b71b-4c48-93fa-2a954c934107.png)

nmtui는 GUI를 사용할 수 있기 때문에 네트워크 설정을 위한 가장 편한 방법이다. ```nmtui```를 입력하면 위와 같은 화면이 뜬다.

![image](https://user-images.githubusercontent.com/124491456/219220182-51ae03d1-5d2c-4bea-b4b3-a3472b08090d.png)

옵션중 'Set system hostname'를 선택 후 위 사진처럼 hostname를 입력 후 OK를 눌러주면 hostname이 설정된다.

![image](https://user-images.githubusercontent.com/124491456/219220416-34139ed5-ae27-4015-bf90-67f49c199387.png)

그리고 'Edit a connection'를 선택해주면 위와 같은 화면이 나타나는데, 여기서 'Edit...'을 선택 후 

![image](https://user-images.githubusercontent.com/124491456/219220562-d463a9c6-defb-44bd-bc61-5c5dfa0a88e0.png)

위 사진의 ```Automatic```을 ```Manual```로 변경해주고

![image](https://user-images.githubusercontent.com/124491456/219220711-806c8ed4-5f52-4af1-90cb-9d8f59ac6ddc.png)

위 사진처럼 IPv4 CONFIGURATION에서 Show를 눌러 Addresses, Gateway, DNS Servers를 Add해주면 된다.

![image](https://user-images.githubusercontent.com/124491456/219221400-c36b213a-5fe6-4d62-bad7-3f803b54d723.png)

그리고 반드시 Automatically connect 왼쪽의 X를 없애줘야한다. 

![image](https://user-images.githubusercontent.com/124491456/219221617-9eaa7826-f006-49ec-b38a-843fafe08c6b.png)

그 다음 Activate a connect에 들어가 설정한 네트워크를 엔터키 두번 누르면 꺼졌다 켜지면서 재설정이 되고, 그후 ```ifconfig```를 통해 네트워크 설정이 제대로 되었는지 확인할 수 있고, ```hostname```을 통해 설정된 hostname을 확인할 수 있다.

#### 2. cli

```
# hostnamectl set-hostname keduit.example.com //hostname 설정
# vim /etc/sysconfig/network-scripts/ifcfg-eth0 
IPADDR=xxx.xxx.xxx.xxx
PREFIX=24
GATEWAY=xxx.xxx.xxx.xxx
DNS1=xxx.xxx.xxx.xxx
# nmcli conn up eth0
```

두번째 방법은 위에 써놓은 커맨드를 이용하는 것이다.

### 3. Add User(Group)

#### 1. 예제1

```
Add 3 users: kim, kang, choi.
The requirements: The Additional group of the two users: kim, kang is the adminuser group. The user: choi's login shell should be non-interactive.
```

```
# groupadd adminuser
# useradd -G adminuser kim //kim을 생성하면서 adminuser 그룹에 추가
# id kim //uid, gid, groups 보여줌
# useradd -G adminuser kang
# id kang
# useradd -s /sbin/nologin choi
# passwd kim
# passwd kang
# passwd choi
```

```
//optional
# usermod -aG admin kim //그룹명 admin에 유저명 kim 추가 
# cat /etc/group | grep 'group name' //필요한 경우 'group name'이 들어간 그룹 있나 조회
```

#### 2. 예제2

```
test11이라는 유저를 추가하고 비밀번호 없이 sudo명령을 사용할 수 있게 만들어라
```

```
# useradd test11
# echo 'test11 ALL=NOPASSWD: ALL' >> /etc/sudoers //ALL대신 명령어를 나열하면 해당 명령어들만 비밀번호 없이 사용가능
```

```
//optional
# vim /etc/sudoers //편집기에 들어가서 직접 맨아래줄에 추가가능
```

#### 3. 예제3

```
Create a user named choi, and the user id should be 1234, and the password should be choi111. Add admin group and set gid=500
```

```
# useradd -u 1234 choi
# passwd choi
# groupadd -g 500 admin
# cat /etc/group | grep admin //admin 그룹의 id 확인가능
```

### 4. Copy file, Change permission

#### 1. 예제1

```
Copy /etc/fstab to /var/tmp. Change owner group to 'admin', the user1 could read, write and modify it, while user2 without any permission.
```

```
# cp /etc/fstab /var/tmp/
# chgrp admin /var/tmp/fstab //fstab 파일의 소유그룹을 admin으로 변경
# setfacl -m u:user1:rwx /var/tmp/fstab //setfacl(sets file access control lists)
# setfacl -m u:user2:--- /var/tmp/fstab
# getfacl /var/tmp/fstab
```

```
//optional
# chown user1 fstab //fstab파일의 소유 유저를 user1으로 설정
```

#### 2. 예제2

```
Find the files owned by choi, and copy all to /root/found
```

```
# find / -user choi | xargs cp -t /root/found //user choi가 소유자인 파일 모두 검색
```

#### 3. 예제3

```
Find the rows that contain pizza from file /etc/pizzafile, and write it to the /tmp/pizza.txt
```

```
grep pizza /etc/pizzafile > /tmp/pizza.txt
```

### 5. Sync git

```
# timedatectl //시간설정 정보 확인
# rpm -aq | grep chrony //chrony가 들어간 패키지(.rpm) 모두 검색
# dnf install chrony //dnf(or yum)명령어로 chrony 설치
# vim /etc/chrony.conf //변경해야할 설정이 있으면 변경
# systemctl enable --now chronyd
# systemctl status chronyd
# timedatectl //시간설정 정보 확인
# chronyc sources -v //정상 연결여부 확인
```

### 6. Base Repo

```
# dnf search plugin core //plugin과 core가 들어간 패키지 검색
# dnf install dnf-plugins-core //config-manager를 사용하기 위하여 패키지 설치
# dnf config-manager --add-repo=https://mirror.kakao.com/centos/8-stream/
# vim /etc/yum.repos.d/mirror.kakao.com_centos_8-stream.repo
gpgkey=x.x.x.x
gpgcheck=1 //1=enable, 0=disable
# dnf clean all
# dnf repolist
```

## 3. 결론  

&nbsp;&nbsp;&nbsp;&nbsp; 확실히 인강을 들으면서 따라할때는 이제 알겠다고 생각했던 것들이 따로 정리해가며 실습해가니 기억나지 않는게 많았다.

---

```bash
클라우드 개발자를 넘어 데브옵스를 꿈꾸는 이제 막 공부를 시작한 초보 엔지니어입니다. 틀린 점이 있으면 친절하게 댓글 부탁드립니다. :)
```

---
