---
layout: single
title: "RHCSA Day2(Crontab, SELinux, IP Forwarding, HTTPD, FTP, Change Tuned, Backup)"
categories: os
tags: [2023/02/17, 운영체제, RHCSA, 레드햇]
toc: true
toc_sticky: true
author_profile: true
comments: true
share: true
related: true
published: true
sidebar: 
    nav: "docs"
---

## 1. 서론  

&nbsp;&nbsp;&nbsp;&nbsp; RHCSA Certificate 공부를 위해 다뤄볼 여러가지 유형들을 복습하기 좋게 정리해보려고 한다.

## 2. 본론  

### 1. Crontab

```
Configure a task: plan to run echo hello command at 14:23 every day.
```

```
# rpm -aq | grep crontab //crontab 패키지 확인
# systemctl enable --now crond
# systemctl status crond
# crontab -e //유저지정이 필요할경우 -u 유저명
23 14 * * * echo "hello" // 분 시 dayofmonth(1-31) month(1-12) dayofweek(0(sun)-6)
# crontab -l //설정 확인
```

```
//optional
# rpm -aq | grep crontab //crontab 패키지 확인
# systemctl enable --now crond
# systemctl status crond
# vim /etc/crontab
23 14 * * * echo "hello" // 분 시 dayofmonth(1-31) month(1-12) dayofweek(0(sun)-6), */2를 넣으면 첫 실행이후 2분마다 반복실행
# crontab -l //설정 확인
```

### 2. SELinux

#### 1. permissive

```
# getenforce //enforcing(SELinux is enabled. SELinux policy에 어긋나는 동작은 모두 차단), disabled(SELinux is disabled), permissive(SELinux policy에 어긋나는 동작은 로그를 남기고 허용)
# vim /etc/selinux/config //지속되게 하려면 편집기 통해 SELINUX= 라인 수정
# fixfiles -F onboot //disabled 상태였을 경우 relabel
```

```
//optional
# sestatus //SELinux 상태 확인할 수 있는 다른 명령어
# setenforce 1 //1(enable), 0(permissive)
```

#### 2. port setting

```
# getenforce
# systemctl status httpd
# semanage port -l | grep http //SELinux에 등록된 port 리스트중 http가 들어가는 포트 조회
# semanage port -a -t http_port_t -p tcp 82
# firewall-cmd --list-all //firewall통과 가능한 목록 조회
# firewall-cmd --zone=public --add-port=82/tcp --permanent //82번포트 firewall 통과 영구적으로 가능하게 설정
# firewall-cmd --reload 
# systemctl enable --now httpd
```

### 3. ip forward(routing)

```
Please open the ip_forward, and take effect permanently.
```

```
# sysctl net.ipv4.ip_forward //if shows 0, means disable. 1 is enable
# sysctl -w net.ipv4.ip_forward=1 //change ip forward to enable
# vim /etc/sysctl.conf //above solutions will disappear after reboot
net.ipv4.ip_forward = 1 //This makes ip forward permanent.
# sysctl -p //make the changes take effect right away
```

### 4. httpd

```
Configure a HTTP server, which can be accessed through
http://station.domain1000.com
Please download the released page from http:/kduit.test.io
```

```
# rpm -aq | grep httpd
# dnf search httpd
# dnf install httpd.x86_64 
# systemctl start httpd
# systemctl enable httpd
# systemctl status httpd
# cd /var/www/html //다운받을 경로로 이동
# wget http://keduit.test.io
# cp keduit.io index.html
# vim /etc/httpd/conf/httpd.conf
NameVirtualHost xxx.xxx.xxx.xxx:xx
<VirtualHost xxx.xxx.xxx.x:xx>
DocumentRoot /var/www/html/
ServerName station.domain1000.com
</VirtualHost>
```

### 5. FTP(+ update kernel)

#### 1. 예제1

```
Install a FTP server, and request to anonymous download from /var/ftp/pub catalog. (it needs you to configure yum direct to the already existing file server.)
```

```
# dnf -y install vsftpd
# vim /etc/vsftpd/vsftpd.conf
anonymous_enable=NO //line12, check
chroot_local_user=YES //line100, uncomment
chroot_list_enable=YES //line101, uncomment
allow_writeable_chroot=YES //add line after line 101
chroot_list_file=/etc/vsftpd/chroot_list //line103, uncomment
ls_recurse_enable=YES //line109, uncomment
listen=NO //line114, set YES if listen only IPv4. But if listen both IPv4 and IPv6, set no
listen_ipv6=No //line123, same above. but Yes means listen both
local_root=public_html //add to the end. specify root directory if you need. otherwise home directory will be the FTP home directory
use_localtime=YES
# vim /etc/vsftpd/chroot_list
add users you allow to move over their home dir
# systemctl enable --now vsftpd
# systemctl status vsftpd
# setsebool -P ftpd_full_access on //if SELinux is enabled
# firewall-cmd --add-service=ftp //if firewall is running
# firewall-cmd --runtime-to-permanent
```

#### 2. 예제2

```
Upgrade the kernel, start the new kernel by default but keep the old kernel available.. kernel download from this address: https://www.elrepo.org/RPM-GPG-KEY-elrepo.org
```

```
# uname -msr //check kernel version
# rpm -aq | grep elrepo
# rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org
# yum install https://www.elrepo.org/elrepo-release-9.el9.elrepo.noarch.rpm
# yum list available --disablerepo='*' --enablerepo=elrepo-kernel
# yum --enablerepo=elrepo-kernel install kernel-ml //ml(lastest mainline kernel)을 lt로 바꾸면 latest long-term support kernel로 변경
# reboot //설치한 커널 선택하여 부팅
# vim /etc/default/grub
GRUB_DEFAULT=saved 확인
# grub2-mkconfig -o /boot/grub2/grub.cfg
# reboot
```

#### 3. 예제3

```
Open kmcrl value of 10 , and can verify in /proc/cmdline
```

```
# vim /boot/grub2
kmcrl = 10 //add this line at the end of set kernelopts="root=/ ~ quiet"
# systemctl reboot
# cat /proc/cmdline
```

#### 4. 예제4

```
Download ftp://xxx.xxx.xxx.xxx/pub/boot.iso to /root, and mounted automatically under /media/cdrom and which take effect automatically at boot-start.
```

```
# cd /root
# wget ftp://xxx.xxx.xxx.xxx/pub/boot.iso
# mkdir -p /media/cdrom
# vim /etc/fstab
/root/boot.iso /media/cdrom iso9660 defaults,loop 0 0
# mount -a
```

### 6. Change tuned to recommended

```
# dnf install -y tuned
# systemctl enable --now tuned
# systemctl status tuned
# tuned-adm recommend
# tuned-adm profile 'profile name' //리부트 후 해당 profile tuned 상태가 유지되는지 체크
```

### 7. Create backup

```
Create a backup file named /root/backuptest.tar.bz2, contains the content of /usr/localtest, tar must use bzip2 to compress.
```

```
# tar -cjvf /root/backuptest.tar.bz2 /usr/localtest
```

## 3. 결론  

&nbsp;&nbsp;&nbsp;&nbsp; 시험 일자를 2월 22일로 잡았다. 그동안 열심히 공부해야겠다.

---

```bash
클라우드 개발자를 넘어 데브옵스를 꿈꾸는 이제 막 공부를 시작한 초보 엔지니어입니다. 틀린 점이 있으면 친절하게 댓글 부탁드립니다. :)
```

---
